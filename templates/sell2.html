{% extends "layout2.html" %}

{% block title %}
    Sell
{% endblock %}

{% block main %}
    <form id="form_sell" method="post">
        <div class="form-group">
            <select class="form-control" name="symbol">
                <option disabled selected value>Symbol</option>
                {% for symbol in symbols %}
                <option value="{{symbol.symbol}}">{{symbol.symbol}}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <input autocomplete="off" autofocus class="form-control" name="shares" placeholder="Shares" type="text">
        </div>
        <button class="btn btn-primary" type="submit">Sell</button>
    </form>
    <div id="error" style="display: none; margin: 50px; width: 300px; margin-left: 380px" class="alert alert-danger" role="alert" >

    </div>

<script>
$( document ).ready(function() {

  $( "#form_sell" ).submit(function( event ) {
    event.preventDefault();
    $("#error").hide();


    var values = $("#form_sell").serializeArray();

    var posting = $.post( "/api/sell", values )
      .done( function(data) {
        window.location.href = "/";
      })
      .fail( function(xhr, textStatus, errorThrown) {
          if (xhr.hasOwnProperty('responseJSON')) {
              $("#error").show();
              $("#error").text(xhr.responseJSON.message);
          } else {
              window.location.href = "apology.html";
          }
      });

  })

})

</script>
{% endblock %}

